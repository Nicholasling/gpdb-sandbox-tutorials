<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Create Users and Roles</title>
    <link href='images/favicon.ico' rel='shortcut icon' type='image/vnd.microsoft.icon'>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="js/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-69171123-1', 'auto');
      ga('send', 'pageview');
    </script>

  </head>
  <body>

      <header>
        <h1>Greenplum Database Tutorials</h1>
        <p>For use with the Greenplum Database Sandbox</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/greenplum-db/gpdb-sandbox-tutorials" class="button fork">View On GitHub</a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/greenplum-db/gpdb-sandbox-tutorials/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/greenplum-db/gpdb-sandbox-tutorials/tarball/master" class="button">TAR</a></li>
            <li><a href="https://network.pivotal.io/products/pivotal-gpdb#/releases/4540/file_groups/566" class="button">SANDBOX VM</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <div id='sidebar'>
        <p><a href='/'>Tutorials Home</a></p>
        <p>
  <span class='list-header'>Introduction</span><br/>
  <a href="/introduction-to-the-greenplum-database-architecture">Introduction to the Greenplum Database Architecture</a><br/>
</p>

<p>
  <span class='list-header'>Get Started</span><br/>
  <a href="/create-users-and-roles">Create Users and Roles</a><br/>
  <a href="/create-and-prepare-database">Create and Prepare Database</a><br/>
  <a href="/create-tables">Create Tables</a> 
</p>

<p>
  <span class='list-header'>Data Loading Unloading</span><br/>
  <a href="/data-loading">Data Loading</a>
</p>

<p>
  <span class='list-header'>Performance Tuning</span><br/>
  <a href="/queries-and-performance-tuning">Queries and Performance Tuning</a>
</p>

<p>
  <span class='list-header'>Analytics</span><br/>
  <a href="/introduction-to-greenplum-in-database-analytics">Introduction to Greenplum In-Database Analytics</a>
</p>

<p>
  <span class='list-header'>Administration</span><br/>
  <a href="/backup-and-recovery-operations">Backup and Recovery Operations</a><br/>
  <a href="/importing-into-vmware-fusion">Importing into VMware Fusion</a>
</p>
      </div>
      <section>

        <h2 class="inline-header">Create Users and Roles</h2>

<p>Greenplum Database manages database access using roles. Initially, there is one superuser roleâ€”the role associated with the OS user who initialized the database instance, usually gpadmin. This user owns all of the Greenplum Database files and OS processes, so it is important to reserve the gpadmin role for system tasks only.  </p>

<p>A role can be a user or a group. A user role can log in to a database; that is, it has the LOGIN attribute. A user or group role can become a member of a group.</p>

<p>Permissions can be granted to users or groups. Initially, of course, only the gpadmin role is able to create roles. You can add roles with the createuser utility command, CREATE ROLE SQL command, or the CREATE USER SQL command. The CREATE USER command is the same as the CREATE ROLE command except that it automatically assigns the role the LOGIN attribute. </p>

<h3>
<a id="exercises" class="anchor" href="#exercises" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercises</h3>

<h4>
<a id="create-a-user-with-the-createuser-utility-command" class="anchor" href="#create-a-user-with-the-createuser-utility-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create a user with the createuser utility command</h4>

<ol>
<li>Login to the GPDB Sandbox as the gpadmin user.<br />
</li>
<li>
<p>Enter the <em>createuser</em> command and reply to the prompts:  </p>

<blockquote>
<p><code>$ createuser -P user1</code></p>

<pre><code>Enter password for new role:
Enter it again:
Shall the new role be a superuser? (y/n) n
Shall the new role be allowed to create databases? (y/n) y
Shall the new role be allowed to create more new roles? (y/n) n
NOTICE:  resource queue required -- using default resource queue
"pg_default"
</code></pre>
</blockquote>
</li>
</ol>

<h4>
<a id="create-a-user-with-the-create-user-command" class="anchor" href="#create-a-user-with-the-create-user-command" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create a user with the CREATE USER command</h4>

<ol>
<li>
<p>Connect to the template1 database as gpadmin:  </p>

<blockquote>
<p><code>$ psql template1</code></p>
</blockquote>
</li>
<li>
<p>Create a user with the name user2:  </p>

<blockquote>
<p><code>template1=#  CREATE USER user2 WITH PASSWORD 'pivotal' NOSUPERUSER;</code>  </p>
</blockquote>
</li>
<li>
<p>Display a list of roles:  </p>

<blockquote>
<pre><code>template1=# \du
                       List of roles
 Role name |            Attributes             | Member of
-----------+-----------------------------------+-----------
 gpadmin   | Superuser, Create role, Create DB |
 gpmon     | Superuser, Create DB              |
 user1     | Create DB                         |
 user2     |                                   |
</code></pre>
</blockquote>
</li>
</ol>

<h4>
<a id="create-a-users-group-and-add-the-users-to-it" class="anchor" href="#create-a-users-group-and-add-the-users-to-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>Create a users group and add the users to it</h4>

<ol>
<li>
<p>While connected to the template1 database as gpadmin enter the following SQL commands:</p>

<blockquote>
<pre><code>    template1=# CREATE ROLE users;
    template1=# GRANT users TO user1, user2;
</code></pre>
</blockquote>
</li>
<li>
<p>Display the list of roles again:</p>

<blockquote>
<pre><code>template1=# \du
                       List of roles
 Role name |            Attributes             | Member of
-----------+-----------------------------------+-----------
 gpadmin   | Superuser, Create role, Create DB |
 gpmon     | Superuser, Create DB              |
 user1     | Create DB                         | {users}
 user2     |                                   | {users}
 users     | Cannot login                      |
</code></pre>
</blockquote>
</li>
<li>
<p>Exit out of the psql shell:  </p>

<blockquote>
<p><code>template1=# \q</code></p>
</blockquote>
</li>
</ol>


      </section>
      <div id='attribution'>
        <p>Project maintained by <a href="https://github.com/greenplum-db">greenplum-db</a> &middot; <small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </div>
    </div>

    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

  </body>
</html>
